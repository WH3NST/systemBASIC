TODO: fixed flawed AND logic
